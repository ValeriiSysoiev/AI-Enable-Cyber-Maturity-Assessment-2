(()=>{var e={};e.id=233,e.ids=[233],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},33166:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o}),t(52149),t(56698),t(35866);var a=t(23191),r=t(88716),n=t(37922),i=t.n(n),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o=["",{children:["admin",{children:["auth",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,52149)),"/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/admin/auth/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,56698)),"/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/admin/auth/page.tsx"],m="/admin/auth/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/auth/page",pathname:"/admin/auth",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},96484:(e,s,t)=>{Promise.resolve().then(t.bind(t,16247))},16247:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var a=t(10326),r=t(79682),n=t(2991),i=t(17577),l=t(6824);function d({className:e=""}){let[s,t]=(0,i.useState)(null),[r,n]=(0,i.useState)("idle"),[d,o]=(0,i.useState)(""),[c,m]=(0,i.useState)(""),x=async()=>{n("loading"),o("");try{let e=await (0,l.SC)("/admin/auth-diagnostics");t(e.diagnostics),m(new Date().toLocaleString()),n("success")}catch(e){o(e instanceof Error?e.message:"Failed to load auth diagnostics"),n("error")}};return"loading"===r?a.jsx("div",{className:`space-y-6 ${e}`,children:(0,a.jsxs)("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4"}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})}):"error"===r?a.jsx("div",{className:`space-y-6 ${e}`,children:(0,a.jsxs)("div",{className:"border rounded p-4 bg-red-50 border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"font-medium text-red-800",children:"Error Loading Diagnostics"}),a.jsx("button",{onClick:x,className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}),a.jsx("p",{className:"text-red-700 text-sm",children:d})]})}):s?(0,a.jsxs)("div",{className:`space-y-6 ${e}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Authentication Diagnostics"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[c&&(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Last updated: ",c]}),a.jsx("button",{onClick:x,disabled:"loading"===r,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"loading"===r?"Refreshing...":"Refresh"})]})]}),a.jsx("div",{className:"border rounded p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-medium",children:"Authentication Mode"}),a.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${"aad"===s.mode?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:"aad"===s.mode?"Azure AD":"Demo"})]})}),(0,a.jsxs)("div",{className:"border rounded p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-medium",children:"Configuration Status"}),a.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${(e=>{switch(e){case"ok":return"text-green-600 bg-green-100";case"warning":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(s.configuration.status)}`,children:s.configuration.status.toUpperCase()})]}),s.configuration.issues&&s.configuration.issues.length>0&&(0,a.jsxs)("div",{className:"mt-3 space-y-1",children:[a.jsx("div",{className:"font-medium text-sm text-red-700",children:"Issues:"}),a.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.configuration.issues.map((e,s)=>a.jsx("li",{className:"text-sm text-red-600",children:e},s))})]})]}),"aad"===s.mode&&s.tenant&&(0,a.jsxs)("div",{className:"border rounded p-4",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Tenant Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"ID:"}),a.jsx("span",{className:"ml-2 font-mono bg-gray-100 px-2 py-1 rounded",children:s.tenant.id})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Name:"}),a.jsx("span",{className:"ml-2",children:s.tenant.name})]})]})]}),s.user&&(0,a.jsxs)("div",{className:"border rounded p-4",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Current User"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Email:"}),a.jsx("span",{className:"ml-2",children:s.user.email})]}),s.user.groups&&s.user.groups.length>0&&(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Groups:"}),a.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:s.user.groups.map((e,s)=>a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:e},s))})]}),s.user.roles&&s.user.roles.length>0&&(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Roles:"}),a.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:s.user.roles.map((e,s)=>a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:e},s))})]})]})]}),s.groups&&s.groups.length>0&&(0,a.jsxs)("div",{className:"border rounded p-4",children:[a.jsx("h3",{className:"font-medium mb-3",children:"AAD Groups & Role Mapping"}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-2",children:"Group Name"}),a.jsx("th",{className:"text-left py-2",children:"Group ID"}),a.jsx("th",{className:"text-left py-2",children:"Mapped Role"})]})}),a.jsx("tbody",{children:s.groups.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t",children:[a.jsx("td",{className:"py-2",children:e.name}),a.jsx("td",{className:"py-2 font-mono text-xs",children:e.id}),a.jsx("td",{className:"py-2",children:e.mapped_role?a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:e.mapped_role}):a.jsx("span",{className:"text-gray-400 text-xs",children:"No mapping"})})]},e.id))})]})})]}),s.roles&&s.roles.length>0&&(0,a.jsxs)("div",{className:"border rounded p-4",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Available Roles"}),a.jsx("div",{className:"space-y-3",children:s.roles.map((e,s)=>(0,a.jsxs)("div",{className:"border-l-4 border-blue-200 pl-3",children:[a.jsx("div",{className:"font-medium text-sm",children:e.name}),e.description&&a.jsx("div",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.permissions&&e.permissions.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Permissions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:e.permissions.map((e,s)=>a.jsx("span",{className:"px-1 py-0.5 bg-gray-100 text-gray-700 rounded text-xs",children:e},s))})]})]},s))})]})]}):a.jsx("div",{className:`space-y-6 ${e}`,children:a.jsx("div",{className:"text-gray-500 text-center py-8",children:"No diagnostics data available"})})}function o(){let e=(0,r.QL)();return e.isLoading?a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"text-center",children:"Loading..."})}):(0,n.GJ)()?(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Admin • Authentication"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["User: ",e.user?.name," • Mode: ","aad"===e.mode.mode?"Azure AD":"Demo"]})]}),a.jsx("div",{className:"text-sm text-gray-600 border-l-4 border-blue-200 pl-4",children:"This page provides diagnostic information about the current authentication configuration, including AAD tenant details, group mappings, and role assignments."}),a.jsx(d,{})]}):a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"text-red-600",children:"Access denied. Admin privileges required."})})}},6824:(e,s,t)=>{"use strict";t.d(s,{$V:()=>o,SC:()=>i,Sg:()=>d,tQ:()=>l});var a=t(2991);let r=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function n(){let e=(0,a.OD)(),s=(0,a.K3)(),t={};return e&&(t["X-User-Email"]=e),s&&(t["X-Engagement-ID"]=s),t}async function i(e,s={}){let t=n(),a=new AbortController,i=setTimeout(()=>a.abort(),s.timeout||3e4);try{let n=await fetch(`${r}${e}`,{...s,signal:a.signal,headers:{...t,...s.headers}});if(clearTimeout(i),!n.ok){let e=await n.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||`Request failed: ${n.status}`)}return n.json()}catch(e){if(clearTimeout(i),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function l(e){let s=new AbortController,t=setTimeout(()=>s.abort(),3e4);try{let a=await fetch(`${r}/presets/${e}`,{cache:"no-store",signal:s.signal});if(clearTimeout(t),!a.ok)throw Error(`Preset ${e} not found`);return a.json()}catch(s){if(clearTimeout(t),s instanceof Error&&"AbortError"===s.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",s),s}}let d=r;function o(e=!1){let s=n();return e||(s["Content-Type"]="application/json"),s}},2991:(e,s,t)=>{"use strict";function a(){return""}function r(){return""}function n(e){}function i(){return(process.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes("")}t.d(s,{GJ:()=>i,K3:()=>r,OD:()=>a,d8:()=>n})},52149:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/admin/auth/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,878,183],()=>t(33166));module.exports=a})();