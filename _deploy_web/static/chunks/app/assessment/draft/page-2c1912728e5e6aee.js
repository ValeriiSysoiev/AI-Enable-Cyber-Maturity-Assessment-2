(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[383],{19049:function(e,t,n){Promise.resolve().then(n.bind(n,67859))},67859:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var r=n(57437),s=n(2265),i=n(29116),o=n(40257);function l(e){var t;let{question:n}=e,[i,l]=(0,s.useState)(!1),[a,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(null);async function f(){l(!0),d(null);try{let e=await fetch("".concat(o.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000","/assist/autofill"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question_text:n.text})});if(e.ok){let t=await e.json();c(t)}else throw Error("Failed to get AI assistance")}catch(e){d(e instanceof Error?e.message:"Failed to get AI assistance")}finally{l(!1)}}return(0,r.jsxs)("div",{className:"bg-white border rounded p-4 space-y-3",children:[(0,r.jsx)("div",{className:"font-medium",children:n.text}),n.level_hints&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[n.level_hints["3"]&&(0,r.jsxs)("span",{children:["L3: ",n.level_hints["3"]]}),n.level_hints["3"]&&n.level_hints["4"]&&(0,r.jsx)("span",{className:"mx-2",children:"•"}),n.level_hints["4"]&&(0,r.jsxs)("span",{children:["L4: ",n.level_hints["4"]]})]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"Evidence:"})," ",null===(t=n.evidence)||void 0===t?void 0:t.join(", ")]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm",children:"Level:"}),(0,r.jsxs)("select",{className:"ml-2 border rounded px-2 py-1",defaultValue:"3",disabled:!0,children:[(0,r.jsx)("option",{children:"1"}),(0,r.jsx)("option",{children:"2"}),(0,r.jsx)("option",{children:"3"}),(0,r.jsx)("option",{children:"4"}),(0,r.jsx)("option",{children:"5"})]}),(0,r.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"read-only (stub)"})]}),(0,r.jsx)("button",{onClick:f,disabled:i,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:i?"Loading...":"AI Assist → Autofill"})]}),u&&(0,r.jsxs)("div",{className:"mt-3 p-3 bg-red-50 rounded text-sm text-red-700",children:["Error: ",u]}),a&&(0,r.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded text-sm",children:[(0,r.jsx)("div",{className:"font-medium text-blue-900",children:"AI Suggestion:"}),(0,r.jsxs)("div",{className:"mt-1 text-blue-800",children:["Proposed Level: ",a.proposed_level]}),(0,r.jsx)("div",{className:"mt-1 text-blue-700",children:a.justification})]})]})}function a(){let[e,t]=(0,s.useState)(null),[n,o]=(0,s.useState)(null),[a,c]=(0,s.useState)(!0),[u,d]=(0,s.useState)(null);if((0,s.useEffect)(()=>{(async()=>{try{var e,n;let r=await (0,i.tQ)("cyber-for-ai");t(r),o(null!==(n=null===(e=r.pillars[0])||void 0===e?void 0:e.id)&&void 0!==n?n:null)}catch(e){d(e instanceof Error?e.message:"Failed to load preset")}finally{c(!1)}})()},[]),a)return(0,r.jsx)("main",{className:"p-8",children:"Loading…"});if(u)return(0,r.jsx)("main",{className:"p-8",children:(0,r.jsxs)("div",{className:"p-4 bg-red-50 text-red-700 rounded",children:["Error: ",u]})});if(!e)return(0,r.jsx)("main",{className:"p-8",children:"No preset loaded"});let f=n?e.questions[n]:[];return(0,r.jsxs)("div",{className:"grid grid-cols-12 min-h-screen",children:[(0,r.jsxs)("aside",{className:"col-span-3 bg-gray-100 p-4 space-y-2",children:[(0,r.jsx)("h2",{className:"font-semibold mb-2",children:"Pillars"}),e.pillars.map(e=>(0,r.jsx)("button",{onClick:()=>o(e.id),className:"block w-full text-left px-3 py-2 rounded ".concat(n===e.id?"bg-white":"hover:bg-white"),children:e.name},e.id))]}),(0,r.jsxs)("main",{className:"col-span-9 p-6 space-y-4",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:e.name}),null==f?void 0:f.map(e=>(0,r.jsx)(l,{question:e},e.id))]})]})}},29116:function(e,t,n){"use strict";n.d(t,{$V:function(){return c},SC:function(){return o},Sg:function(){return a},tQ:function(){return l}});var r=n(16023);let s=n(40257).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function i(){let e=(0,r.OD)(),t=(0,r.K3)(),n={};return e&&(n["X-User-Email"]=e),t&&(n["X-Engagement-ID"]=t),n}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i(),r=new AbortController,o=setTimeout(()=>r.abort(),t.timeout||3e4);try{let i=await fetch("".concat(s).concat(e),{...t,signal:r.signal,headers:{...n,...t.headers}});if(clearTimeout(o),!i.ok){let e=await i.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||"Request failed: ".concat(i.status))}return i.json()}catch(e){if(clearTimeout(o),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function l(e){let t=new AbortController,n=setTimeout(()=>t.abort(),3e4);try{let r=await fetch("".concat(s,"/presets/").concat(e),{cache:"no-store",signal:t.signal});if(clearTimeout(n),!r.ok)throw Error("Preset ".concat(e," not found"));return r.json()}catch(t){if(clearTimeout(n),t instanceof Error&&"AbortError"===t.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",t),t}}let a=s;function c(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=i();return e||(t["Content-Type"]="application/json"),t}},16023:function(e,t,n){"use strict";n.d(t,{GJ:function(){return a},K3:function(){return i},OD:function(){return s},Pk:function(){return l},d8:function(){return o}});var r=n(40257);function s(){return localStorage.getItem("email")||""}function i(){return localStorage.getItem("engagementId")||""}function o(e){localStorage.setItem("engagementId",e)}async function l(e){return s()||(await e.push("/signin"),"")}function a(){let e=s();return(r.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes(e.toLowerCase())}},40257:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(44227)},44227:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?a=r.concat(a):u=-1,a.length&&f())}function f(){if(!c){var e=l(d);c=!0;for(var t=a.length;t;){for(r=a,a=[];++u<t;)r&&r[u].run();u=-1,t=a.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new h(e,t)),1!==a.length||c||l(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}},o=!0;try{t[e](i,i.exports,r),o=!1}finally{o&&delete n[e]}return i.exports}r.ab="//";var s=r(229);e.exports=s}()}},function(e){e.O(0,[971,117,744],function(){return e(e.s=19049)}),_N_E=e.O()}]);