(()=>{var e={};e.id=297,e.ids=[297],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},60413:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(23946),s(56698),s(35866);var r=s(23191),n=s(88716),a=s(37922),o=s.n(a),i=s(95231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let d=["",{children:["e",{children:["[engagementId]",{children:["workshops",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,23946)),"/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/e/[engagementId]/workshops/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,56698)),"/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/e/[engagementId]/workshops/page.tsx"],m="/e/[engagementId]/workshops/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/e/[engagementId]/workshops/page",pathname:"/e/[engagementId]/workshops",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},34052:(e,t,s)=>{Promise.resolve().then(s.bind(s,84877))},84877:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(10326),n=s(17577),a=s(35047),o=s(90434),i=s(66274);function l({isOpen:e,onClose:t,onSuccess:a,engagementId:o}){let[i,l]=(0,n.useState)({title:"",attendees:[{user_id:"",email:"",role:"Member"}]}),[d,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),x=async e=>{e.preventDefault(),c(!0),u("");try{let{createWorkshop:e}=await Promise.resolve().then(s.bind(s,66274));await e(o,i),a(),t(),l({title:"",attendees:[{user_id:"",email:"",role:"Member"}]})}catch(e){u(e instanceof Error?e.message:"Failed to create workshop")}finally{c(!1)}},h=e=>{l(t=>({...t,attendees:t.attendees.filter((t,s)=>s!==e)}))},p=(e,t,s)=>{l(r=>({...r,attendees:r.attendees.map((r,n)=>n===e?{...r,[t]:s}:r)}))};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"New Workshop"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Workshop Title"}),r.jsx("input",{type:"text",value:i.title,onChange:e=>l(t=>({...t,title:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Attendees"}),r.jsx("button",{type:"button",onClick:()=>{l(e=>({...e,attendees:[...e.attendees,{user_id:"",email:"",role:"Member"}]}))},className:"text-sm text-blue-600 hover:text-blue-700",children:"+ Add Attendee"})]}),i.attendees.map((e,t)=>(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-3 mb-3",children:[r.jsx("div",{className:"col-span-4",children:r.jsx("input",{type:"email",placeholder:"Email",value:e.email,onChange:e=>p(t,"email",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})}),r.jsx("div",{className:"col-span-3",children:r.jsx("input",{type:"text",placeholder:"User ID",value:e.user_id,onChange:e=>p(t,"user_id",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})}),r.jsx("div",{className:"col-span-3",children:(0,r.jsxs)("select",{value:e.role,onChange:e=>p(t,"role",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"Member",children:"Member"}),r.jsx("option",{value:"Lead",children:"Lead"}),r.jsx("option",{value:"Observer",children:"Observer"})]})}),r.jsx("div",{className:"col-span-2",children:i.attendees.length>1&&r.jsx("button",{type:"button",onClick:()=>h(t),className:"w-full h-full text-red-600 hover:text-red-700 flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},t))]}),m&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:r.jsx("p",{className:"text-sm text-red-600",children:m})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:d?"Creating...":"Create Workshop"})]})]})]})})}):null}function d({workshop:e}){let t=(0,i.t6)(e),s=(0,i.Ao)(e);return(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 hover:shadow-lg transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx(o.default,{href:`/e/${e.engagement_id}/workshops/${e.id}`,className:"block group",children:r.jsx("h3",{className:"text-lg font-medium text-gray-900 group-hover:text-indigo-600",children:e.title})}),(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.attendees.length," attendees"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.consented,"/",t.total," consented (",t.percentage,"%)"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Created ",new Date(e.created_at).toLocaleDateString()]})]})]}),r.jsx("div",{className:"ml-4 flex flex-col items-end space-y-2",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.started?"bg-green-100 text-green-800":s?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:e.started?"Started":s?"Ready":"Pending Consent"})})]}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[r.jsx(o.default,{href:`/e/${e.engagement_id}/workshops/${e.id}`,className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",children:"View Details â†’"}),r.jsx("button",{className:`px-3 py-1 text-sm font-medium rounded-md ${s&&!e.started?"text-white bg-green-600 hover:bg-green-700":"text-gray-500 bg-gray-100 cursor-not-allowed"}`,disabled:!s||e.started,children:e.started?"Started":"Start Workshop"})]})]})}function c(){let e=(0,a.useParams)().engagementId,[t,s]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0),[m,u]=(0,n.useState)(""),[x,h]=(0,n.useState)(!1),p=async()=>{try{c(!0);let t=await (0,i.SA)(e);s(t.workshops)}catch(e){u(e instanceof Error?e.message:"Failed to load workshops")}finally{c(!1)}};return o?r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-6"}),r.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},e))})]})})}):r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"bg-white shadow-sm rounded-lg px-6 py-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Workshops"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage workshop consent and participation"})]}),r.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"New Workshop"})]})}),m&&r.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:m})}),0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No workshops"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new workshop."}),r.jsx("div",{className:"mt-6",children:(0,r.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Workshop"]})})]}):r.jsx("div",{className:"space-y-4",children:t.map(e=>r.jsx(d,{workshop:e},e.id))}),r.jsx(l,{isOpen:x,onClose:()=>h(!1),onSuccess:()=>{p(),h(!1)},engagementId:e})]})})}},6824:(e,t,s)=>{"use strict";s.d(t,{$V:()=>d,SC:()=>o,Sg:()=>l,tQ:()=>i});var r=s(2991);let n=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function a(){let e=(0,r.OD)(),t=(0,r.K3)(),s={};return e&&(s["X-User-Email"]=e),t&&(s["X-Engagement-ID"]=t),s}async function o(e,t={}){let s=a(),r=new AbortController,o=setTimeout(()=>r.abort(),t.timeout||3e4);try{let a=await fetch(`${n}${e}`,{...t,signal:r.signal,headers:{...s,...t.headers}});if(clearTimeout(o),!a.ok){let e=await a.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||`Request failed: ${a.status}`)}return a.json()}catch(e){if(clearTimeout(o),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function i(e){let t=new AbortController,s=setTimeout(()=>t.abort(),3e4);try{let r=await fetch(`${n}/presets/${e}`,{cache:"no-store",signal:t.signal});if(clearTimeout(s),!r.ok)throw Error(`Preset ${e} not found`);return r.json()}catch(t){if(clearTimeout(s),t instanceof Error&&"AbortError"===t.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",t),t}}let l=n;function d(e=!1){let t=a();return e||(t["Content-Type"]="application/json"),t}},2991:(e,t,s)=>{"use strict";function r(){return""}function n(){return""}function a(e){}function o(){return(process.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes("")}s.d(t,{GJ:()=>o,K3:()=>n,OD:()=>r,d8:()=>a})},66274:(e,t,s)=>{"use strict";s.d(t,{Ao:()=>l,SA:()=>a,aM:()=>o,createWorkshop:()=>n,t6:()=>d,u7:()=>i});var r=s(6824);async function n(e,t){let s={engagement_id:e,title:t.title,start_ts:t.start_ts||null,attendees:t.attendees};return await (0,r.SC)("/api/v1/workshops",{method:"POST",headers:{"Content-Type":"application/json","X-Engagement-ID":e},body:JSON.stringify(s)})}async function a(e,t=1,s=50){let n=new URLSearchParams({engagement_id:e,page:t.toString(),page_size:s.toString()});return await (0,r.SC)(`/api/v1/workshops?${n}`,{headers:{"X-Engagement-ID":e}})}async function o(e,t,s){return await (0,r.SC)(`/api/v1/workshops/${t}/consent`,{method:"POST",headers:{"Content-Type":"application/json","X-Engagement-ID":e},body:JSON.stringify(s)})}async function i(e,t){return await (0,r.SC)(`/api/v1/workshops/${t}/start`,{method:"POST",headers:{"X-Engagement-ID":e}})}function l(e){return e.attendees.every(e=>void 0!==e.consent)}function d(e){let t=e.attendees.length,s=e.attendees.filter(e=>e.consent).length;return{total:t,consented:s,pending:t-s,percentage:t>0?Math.round(s/t*100):0}}},23946:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/e/[engagementId]/workshops/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,878,183],()=>s(60413));module.exports=r})();