STG LogDoctor Analysis Report
============================
Environment: STG (web-cybermat-stg, rg-cybermat-stg)
Timestamp: 2025-08-19T01:52:00Z
Agent: LogDoctor

OVERVIEW
--------
Analysis of staging deployment logs shows successful deployment and self-healing process. 
Only web-cybermat-stg exists in staging environment (no separate API service).

DEPLOYMENT TIMELINE
------------------
1. First deployment: 2025-08-19T01:05:44 (commit d178bf05-5)
   - Size: 5.38 MB
   - Status: Successful
   - Files synced: 47 files
   - Deployment time: ~17 seconds

2. Second deployment: 2025-08-19T01:33:49 (commit 9a5c6301-a)
   - Size: 5.77 MB
   - Status: Successful
   - Files synced: 206 files
   - Deployment time: ~25 seconds

IDENTIFIED ISSUES AND PATTERNS
------------------------------
1. Missing package.json errors (RESOLVED):
   - Multiple npm ENOENT errors for /package.json before deployments
   - Error pattern: "Could not read package.json: Error: ENOENT: no such file or directory"
   - Resolution: Fixed after successful deployment

2. Missing standalone server.js (RESOLVED):
   - Error: "Cannot find module '/home/site/wwwroot/.next/standalone/server.js'"
   - Occurred during startup attempts before final deployment
   - Resolution: Self-healing occurred during deployment process

3. SSL certificate warnings (INFORMATIONAL):
   - Recurring warning: "rehash: warning: skipping ca-certificates.crt"
   - Impact: Non-blocking, certificate updates continue successfully

SUCCESSFUL STARTUP SEQUENCE
---------------------------
Final successful startup at 2025-08-19T01:48:38:
1. PM2 process manager initialized successfully
2. Next.js 14.2.31 application started
3. Server listening on port 8080
4. Ready time: 4.2s initially, then 995ms on restart
5. PM2 process status: online, PID 1129, memory usage: 35.2mb

SELF-HEALING EVIDENCE
--------------------
- Multiple container restart cycles observed
- Each restart attempted to resolve missing dependencies
- Final deployment provided correct file structure
- Application successfully started after deployment completion

CONTAINER RESTARTS
-----------------
Observed restart sequence:
- 00:49:19 - Initial startup attempt
- 00:50:21 - Second restart
- 01:01:13 - Third restart (failed due to missing server.js)
- 01:06:38 - Fourth restart
- 01:34:43 - Post-deployment startup (partial success)
- 01:47:36 - Final successful startup with PM2

PERFORMANCE METRICS
------------------
- Node.js version: v20.19.3
- Application: Next.js 14.2.31
- Process manager: PM2 (fork mode, single instance)
- Memory usage: 35.2mb (stable)
- CPU usage: 0% (idle state)
- Startup time: 995ms (optimized after initial deployment)

RECOMMENDATIONS
--------------
1. Monitor for recurring package.json issues in future deployments
2. Ensure proper build artifacts are included in deployment packages
3. Consider implementing health checks to reduce restart frequency
4. SSL certificate warnings are non-critical but could be addressed

DEPLOYMENT HEALTH
----------------
Status: HEALTHY
- Deployments completing successfully
- Application responding normally
- No critical errors in current logs
- Self-healing mechanism functioning as expected

Log analysis completed successfully. Staging environment is operational.