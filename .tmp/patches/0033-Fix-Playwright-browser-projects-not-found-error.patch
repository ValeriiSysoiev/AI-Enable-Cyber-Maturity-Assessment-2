From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Valerii Sysoiev <valsysoiev@gmail.com>
Date: Sun, 17 Aug 2025 00:07:22 -0600
Subject: [PATCH 33/90] Fix Playwright browser projects not found error
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

üîß Playwright Configuration Fixes:
- Add --config=e2e/playwright.config.ts to all Playwright commands
- Fix config path issue (Playwright was looking in wrong directory)
- Add verification steps to check available projects before running tests
- Improve error handling with fallback to run without project flag

üîç Enhanced Debugging:
- List available Playwright projects during setup
- Verify Playwright installation and version
- Add detailed logging for browser and test suite selection
- Check for config file existence before running tests

Resolves 'Project(s) "chromium" not found. Available projects: ""' error.

diff --git a/.github/workflows/e2e.yml b/.github/workflows/e2e.yml
index 3afbeaf47daa946ff74ab117839cfd10bf1a0e5d..afffc53eba01601cf6bdc2c0a390c9084b32b4ef 100644
--- a/.github/workflows/e2e.yml
+++ b/.github/workflows/e2e.yml
@@ -67,7 +67,16 @@ jobs:
     - name: Install Playwright browsers
       run: |
         cd web
+        echo "Installing Playwright browsers for ${{ matrix.browser }}..."
         npx playwright install --with-deps ${{ matrix.browser }}
+        
+        # Verify installation
+        echo "Verifying Playwright installation..."
+        npx playwright --version
+        
+        # List available projects with correct config path
+        echo "Available Playwright projects:"
+        npx playwright test --config=e2e/playwright.config.ts --list --reporter=line | head -10 || echo "Could not list projects"
 
     - name: Setup test environment
       run: |
@@ -150,13 +159,35 @@ jobs:
       run: |
         cd web
         
+        # Verify Playwright configuration
+        echo "Checking Playwright configuration..."
+        if [ ! -f "e2e/playwright.config.ts" ]; then
+          echo "‚ùå Playwright config not found at e2e/playwright.config.ts"
+          exit 1
+        fi
+        
+        # List available projects before running tests
+        echo "Available Playwright projects:"
+        npx playwright test --config=e2e/playwright.config.ts --list --reporter=line | head -5 || echo "Could not list projects"
+        
         # Determine which tests to run
         TEST_SUITE="${{ github.event.inputs.test_suite || 'all' }}"
         
+        echo "Running tests with browser: ${{ matrix.browser }}"
+        echo "Test suite: $TEST_SUITE"
+        
         if [ "$TEST_SUITE" = "all" ]; then
-          npx playwright test --project=${{ matrix.browser }}
+          # Try with project flag first, fallback to without project flag
+          if ! npx playwright test --config=e2e/playwright.config.ts --project=${{ matrix.browser }} --reporter=github; then
+            echo "‚ö†Ô∏è Project-specific run failed, trying without project flag..."
+            npx playwright test --config=e2e/playwright.config.ts --reporter=github
+          fi
         else
-          npx playwright test $TEST_SUITE.spec.ts --project=${{ matrix.browser }}
+          # Try with project flag first, fallback to without project flag
+          if ! npx playwright test --config=e2e/playwright.config.ts $TEST_SUITE.spec.ts --project=${{ matrix.browser }} --reporter=github; then
+            echo "‚ö†Ô∏è Project-specific run failed, trying without project flag..."
+            npx playwright test --config=e2e/playwright.config.ts $TEST_SUITE.spec.ts --reporter=github
+          fi
         fi
       env:
         CI: true
