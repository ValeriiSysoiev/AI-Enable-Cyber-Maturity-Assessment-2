"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{43610:function(e,s,t){t.d(s,{Z:function(){return i}});var a=t(57437),n=t(2265),d=t(4062),r=t(16023);function l(e){let{className:s="",engagementId:t,showConfig:d=!0,showDocumentStatus:l=!0}=e,[i,c]=(0,n.useState)(null),[x,o]=(0,n.useState)(null),[m,u]=(0,n.useState)([]),[h,g]=(0,n.useState)(!0),[p,j]=(0,n.useState)(null),[y,b]=(0,n.useState)(!1);async function f(){try{g(!0),j(null);let e=await fetch("/api/proxy/system/rag-config");if(e.ok){let s=await e.json();c(s)}let s=await fetch("/api/proxy/system/health");if(s.ok){let e=await s.json();o(e)}if(t&&l){let e=await fetch("/api/proxy/engagements/".concat(t,"/docs/ingestion-status"));if(e.ok){let s=await e.json();u(s)}}}catch(e){j(e instanceof Error?e.message:"Failed to load RAG status")}finally{g(!1)}}async function N(){b(!0),await f(),b(!1)}async function v(){if(i&&(0,r.GJ)())try{b(!0);let e=await fetch("/api/proxy/system/rag-test",{method:"POST"});if(e.ok){let s=await e.json();alert("RAG Test: ".concat(s.status,"\n").concat(s.message))}else alert("RAG test failed")}catch(e){alert("RAG test error: ".concat(e))}finally{b(!1)}}return((0,n.useEffect)(()=>{f()},[t]),h)?(0,a.jsx)("div",{className:"rounded-xl border p-4 ".concat(s),children:(0,a.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})}):(0,a.jsxs)("div",{className:"space-y-4 ".concat(s),children:[d&&i&&(0,a.jsxs)("div",{className:"rounded-xl border p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"font-medium text-lg",children:"RAG System Status"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:N,disabled:y,className:"text-xs text-gray-600 hover:text-gray-800 border border-gray-300 px-2 py-1 rounded",children:y?"⟳ Refreshing...":"\uD83D\uDD04 Refresh"}),(0,r.GJ)()&&(0,a.jsx)("button",{onClick:v,disabled:y,className:"text-xs text-blue-600 hover:text-blue-800 border border-blue-300 px-2 py-1 rounded",children:"\uD83E\uDDEA Test RAG"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-gray-700",children:"Configuration"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Mode:"}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat("azure_openai"===i.mode?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:i.mode})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,a.jsxs)("span",{className:"px-2 py-0.5 rounded text-xs font-medium border ".concat(function(e){switch(e){case"healthy":return"text-green-600 bg-green-50 border-green-200";case"degraded":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"offline":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}(i.status)),children:[function(e){switch(e){case"healthy":return"\uD83D\uDFE2";case"degraded":return"\uD83D\uDFE1";case"offline":return"\uD83D\uDD34";default:return"❓"}}(i.status)," ",i.status]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Enabled:"}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs ".concat(i.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:i.enabled?"✓ Yes":"✗ No"})]}),i.model&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Model:"}),(0,a.jsx)("span",{className:"text-gray-900 font-mono text-xs",children:i.model})]}),i.version&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Version:"}),(0,a.jsx)("span",{className:"text-gray-900 font-mono text-xs",children:i.version})]}),i.last_check&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Last Check:"}),(0,a.jsx)("span",{className:"text-gray-900 text-xs",children:new Date(i.last_check).toLocaleString()})]})]})]}),x&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-gray-700",children:"System Health"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Search Index:"}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs ".concat(x.search_index_healthy?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:x.search_index_healthy?"\uD83D\uDFE2 Healthy":"\uD83D\uDD34 Unhealthy"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Embeddings:"}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs ".concat(x.embeddings_service_healthy?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:x.embeddings_service_healthy?"\uD83D\uDFE2 Healthy":"\uD83D\uDD34 Unhealthy"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Documents:"}),(0,a.jsxs)("span",{className:"text-gray-900 text-xs",children:[x.indexed_documents,"/",x.total_documents," indexed"]})]}),x.pending_documents>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pending:"}),(0,a.jsxs)("span",{className:"text-yellow-600 text-xs",children:["⏳ ",x.pending_documents]})]}),x.failed_documents>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Failed:"}),(0,a.jsxs)("span",{className:"text-red-600 text-xs",children:["❌ ",x.failed_documents]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Last Update:"}),(0,a.jsx)("span",{className:"text-gray-900 text-xs",children:new Date(x.last_index_update).toLocaleString()})]})]})]})]}),p&&(0,a.jsx)("div",{className:"mt-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded px-3 py-2",children:p})]}),l&&t&&m.length>0&&(0,a.jsxs)("div",{className:"rounded-xl border p-4",children:[(0,a.jsx)("div",{className:"font-medium text-lg mb-4",children:"Document Processing Status"}),(0,a.jsx)("div",{className:"space-y-2",children:m.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"text-lg",children:function(e){switch(e){case"completed":return"✅";case"processing":return"⏳";case"pending":return"⏱️";case"failed":return"❌";default:return"❓"}}(e.status)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900 truncate",children:["Document ",e.document_id.slice(-8)]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Status: ",e.status,e.chunks_created&&" • ".concat(e.chunks_created," chunks"),e.processed_at&&" • ".concat(new Date(e.processed_at).toLocaleString())]})]})]}),(0,a.jsx)("div",{className:"px-2 py-1 rounded text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-800":"processing"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})]},e.document_id))}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{children:["Total: ",m.length," documents"]}),(0,a.jsxs)("span",{children:["Completed: ",m.filter(e=>"completed"===e.status).length]})]})})]}),!(null==i?void 0:i.enabled)&&(0,a.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-amber-600",children:"⚠️"}),(0,a.jsx)("span",{className:"font-medium text-amber-900",children:"RAG Not Available"})]}),(0,a.jsxs)("div",{className:"text-sm text-amber-800 space-y-1",children:[(0,a.jsx)("div",{children:"• RAG (Retrieval-Augmented Generation) is currently disabled"}),(0,a.jsx)("div",{children:"• Evidence search will use basic text matching"}),(0,a.jsx)("div",{children:"• Contact your administrator to enable advanced AI-powered search"})]})]}),(null==i?void 0:i.enabled)&&(0,a.jsxs)("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-blue-600",children:"\uD83D\uDCA1"}),(0,a.jsx)("span",{className:"font-medium text-blue-900",children:"RAG Tips"})]}),(0,a.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsx)("div",{children:"• Ask specific questions for better grounded answers"}),(0,a.jsx)("div",{children:"• Use domain-specific terminology for more relevant results"}),(0,a.jsx)("div",{children:"• Combine keywords with context for improved accuracy"}),(0,a.jsx)("div",{children:"• Check citation relevance scores to gauge confidence"})]})]})]})}function i(e){let{className:s=""}=e,[t,i]=(0,n.useState)(!1),[c,x]=(0,n.useState)(null),[o,m]=(0,n.useState)(null),[u,h]=(0,n.useState)("");if(!(0,r.GJ)())return null;async function g(){if(!u.trim()){m("Please enter an engagement ID");return}try{i(!0),m(null),x(null);let e=await (0,d.kR)({engagement_id:u.trim(),force:!0});x(e)}catch(e){m(e instanceof Error?e.message:"Bulk reindex failed")}finally{i(!1)}}async function p(){try{i(!0),m(null),x(null);let e=await (0,d.kR)({engagement_id:"*",force:!0});x(e)}catch(e){m(e instanceof Error?e.message:"Global reindex failed")}finally{i(!1)}}return(0,a.jsxs)("div",{className:"space-y-6 ".concat(s),children:[(0,a.jsx)(l,{showConfig:!0,showDocumentStatus:!1}),(0,a.jsxs)("div",{className:"rounded-xl border p-4 space-y-4",children:[(0,a.jsx)("div",{className:"font-medium text-lg",children:"Evidence Administration"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Admin-only tools for managing evidence search indexes"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"font-medium",children:"Reindex Engagement"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Enter engagement ID",className:"flex-1 px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),(0,a.jsx)("button",{onClick:g,disabled:t||!u.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Reindexing...":"Reindex"})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-4 border-t",children:[(0,a.jsx)("div",{className:"font-medium",children:"Global Operations"}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("button",{onClick:p,disabled:t,className:"px-4 py-2 bg-orange-600 text-white rounded-md text-sm hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Reindexing...":"Reindex All Engagements"})}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"⚠️ This will reindex all documents across all engagements. Use with caution."})]}),o&&(0,a.jsxs)("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded px-3 py-2",children:["Error: ",o]}),c&&(0,a.jsxs)("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded px-3 py-2",children:[(0,a.jsxs)("div",{className:"font-medium",children:["✓ ",c.message]}),(0,a.jsxs)("div",{className:"text-xs mt-1",children:["Documents queued: ",c.documents_queued,c.estimated_completion_time&&(0,a.jsxs)(a.Fragment,{children:[" • Estimated completion: ",c.estimated_completion_time]})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t text-xs text-gray-500 space-y-1",children:[(0,a.jsx)("div",{children:"• Documents are processed in the background"}),(0,a.jsx)("div",{children:"• Check individual engagement dashboards for ingestion status"}),(0,a.jsx)("div",{children:"• Large document sets may take several minutes to process"}),(0,a.jsx)("div",{children:"• RAG functionality requires documents to be successfully indexed"})]})]})]})}},99376:function(e,s,t){var a=t(35475);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})}}]);