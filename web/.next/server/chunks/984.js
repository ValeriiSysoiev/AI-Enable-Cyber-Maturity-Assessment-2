exports.id=984,exports.ids=[984],exports.modules={34770:(e,t,s)=>{Promise.resolve().then(s.bind(s,79682)),Promise.resolve().then(s.bind(s,70952))},39138:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},79682:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>o,QL:()=>c,aC:()=>l});var r=s(10326),a=s(17577),n=s(35047);let i=(0,a.createContext)(null);function o({children:e}){let[t,s]=(0,a.useState)(null),[o,l]=(0,a.useState)({mode:"demo",enabled:!0}),[c,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)();return(0,n.useRouter)(),r.jsx(i.Provider,{value:{user:t,mode:o,isAuthenticated:!!t,isLoading:c,error:u},children:e})}function l(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function c(){let e=l();return(0,n.useRouter)(),e}},70952:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var r=s(10326),a=s(33265),n=s(35047),i=s(17577),o=s(90434),l=s(79682);let c=(0,a.default)(async()=>{},{loadableGenerated:{modules:["components/TopNav.tsx -> ./EngagementSwitcher"]},ssr:!1});function d(){(0,n.usePathname)();let[e,t]=(0,i.useState)(null),s=(0,l.aC)();async function a(){"aad"===s.mode.mode?window.location.href="/api/auth/signout":(localStorage.removeItem("email"),localStorage.removeItem("engagementId"),window.location.href="/signin")}return r.jsx("nav",{className:"bg-white border-b px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-8",children:[r.jsx("h1",{className:"text-lg font-semibold",children:"AI Maturity Tool"}),(0,r.jsxs)("div",{className:"flex space-x-6",children:[r.jsx("a",{href:"/",className:"text-sm hover:text-blue-600",children:"Home"}),r.jsx("a",{href:"/new",className:"text-sm hover:text-blue-600",children:"New Assessment"}),r.jsx("a",{href:"/engagements",className:"text-sm hover:text-blue-600",children:"Engagements"}),e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(o.default,{href:`/e/${e}/dashboard`,className:"text-sm hover:text-blue-600",children:"Dashboard"}),r.jsx(o.default,{href:`/e/${e}/demo`,className:"text-sm hover:text-blue-600",children:"Demo"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[s.isAuthenticated&&s.user&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.user.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${"aad"===s.mode.mode?"bg-green-500":"bg-blue-500"}`}),"aad"===s.mode.mode?"Azure AD":"Demo Mode"]})]}),r.jsx("button",{onClick:a,className:"text-sm text-gray-600 hover:text-gray-900 px-2 py-1 rounded hover:bg-gray-100",children:"Sign Out"})]}),r.jsx(c,{})]})]})})}},24349:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(10326),a=s(17577),n=s(89249);function i({engagementId:e,className:t="",isAdminView:i=!1,defaultPageSize:o=20}){let[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(1),[m,g]=(0,a.useState)(o),[h,x]=(0,a.useState)(0),[p,y]=(0,a.useState)(!1),[b,f]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!0),[w,N]=(0,a.useState)(""),[S,_]=(0,a.useState)(""),[E,A]=(0,a.useState)(""),[C,P]=(0,a.useState)(null),I=async()=>{j(!0),N("");try{let t;if(i){let{getGlobalAuditLogs:e}=await Promise.resolve().then(s.bind(s,89249));t=await e(d,m,S||void 0,E||void 0)}else t=await (0,n.FA)(e,d,m,S||void 0);c(t.entries),x(t.total_count),y(t.has_next),f(t.has_prev)}catch(e){N(e.message)}finally{j(!1)}},R=e=>{u(e)},T=e=>{g(e),u(1)},k=e=>{_(e),u(1)},D=e=>{A(e),u(1)},M=e=>{P(C===e?null:e)},$=e=>{switch(e){case"data_export_requested":case"data_export_completed":return"bg-blue-100 text-blue-800";case"data_purge_requested":case"data_purge_completed":return"bg-red-100 text-red-800";case"consent_given":return"bg-green-100 text-green-800";case"consent_withdrawn":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},O=e=>e&&0!==Object.keys(e).length?Object.entries(e).map(([e,t])=>(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:[e,":"]}),r.jsx("span",{className:"ml-1 font-mono",children:"object"==typeof t?JSON.stringify(t,null,2):String(t)})]},e)):null;return v?r.jsx("div",{className:`space-y-4 ${t}`,children:r.jsx("div",{className:"animate-pulse space-y-2",children:[1,2,3,4,5].map(e=>r.jsx("div",{className:"h-16 bg-gray-200 rounded"},e))})}):(0,r.jsxs)("div",{className:`space-y-6 ${t}`,children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Type"}),(0,r.jsxs)("select",{value:S,onChange:e=>k(e.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"All Actions"}),["data_export_requested","data_export_completed","data_purge_requested","data_purge_completed","data_accessed","consent_given","consent_withdrawn"].map(e=>r.jsx("option",{value:e,children:(0,n.EQ)(e)},e))]})]}),i&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Engagement ID"}),r.jsx("input",{type:"text",value:E,onChange:e=>D(e.target.value),placeholder:"Filter by engagement",className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Per Page"}),(0,r.jsxs)("select",{value:m,onChange:e=>T(Number(e.target.value)),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:20,children:"20"}),r.jsx("option",{value:50,children:"50"}),r.jsx("option",{value:100,children:"100"})]})]})]}),r.jsx("button",{onClick:I,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 border",children:"Refresh"})]}),w&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:r.jsx("p",{className:"text-sm text-red-600",children:w})}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",l.length," of ",h.toLocaleString()," audit log entries",(S||E)&&(0,r.jsxs)("span",{className:"ml-2",children:["(filtered)",r.jsx("button",{onClick:()=>{_(""),A(""),u(1)},className:"ml-1 text-blue-600 hover:text-blue-800 underline",children:"Clear filters"})]})]}),0===l.length?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No audit log entries found."}):r.jsx("div",{className:"space-y-2",children:l.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${$(e.action)}`,children:(0,n.EQ)(e.action)}),r.jsx("span",{className:"text-sm font-medium",children:e.user_email}),r.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.timestamp).toLocaleString()})]}),i&&(0,r.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[r.jsx("span",{className:"font-medium",children:"Engagement:"}),r.jsx("span",{className:"ml-1 font-mono text-xs",children:e.engagement_id})]}),e.ip_address&&(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["IP: ",e.ip_address]})]}),(Object.keys(e.details).length>0||e.user_agent)&&r.jsx("button",{onClick:()=>M(e.id),className:"ml-4 p-1 text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:`w-4 h-4 transition-transform ${C===e.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),C===e.id&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-2",children:[e.user_agent&&(0,r.jsxs)("div",{className:"text-xs",children:[r.jsx("span",{className:"text-gray-500",children:"User Agent:"}),r.jsx("div",{className:"mt-1 font-mono text-xs break-all bg-gray-50 p-2 rounded",children:e.user_agent})]}),Object.keys(e.details).length>0&&(0,r.jsxs)("div",{className:"text-xs",children:[r.jsx("span",{className:"text-gray-500",children:"Details:"}),r.jsx("div",{className:"mt-1 bg-gray-50 p-2 rounded space-y-1",children:O(e.details)})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:["Log ID: ",e.id]})]})]},e.id))}),(p||b)&&(0,r.jsxs)("div",{className:"flex items-center justify-between border-t pt-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",d," of ",Math.ceil(h/m)]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>R(d-1),disabled:!b,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),r.jsx("button",{onClick:()=>R(d+1),disabled:!p,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}},6824:(e,t,s)=>{"use strict";s.d(t,{$V:()=>c,SC:()=>i,Sg:()=>l,tQ:()=>o});var r=s(2991);let a=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function n(){let e=(0,r.OD)(),t=(0,r.K3)(),s={};return e&&(s["X-User-Email"]=e),t&&(s["X-Engagement-ID"]=t),s}async function i(e,t={}){let s=n(),r=new AbortController,i=setTimeout(()=>r.abort(),t.timeout||3e4);try{let n=await fetch(`${a}${e}`,{...t,signal:r.signal,headers:{...s,...t.headers}});if(clearTimeout(i),!n.ok){let e=await n.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||`Request failed: ${n.status}`)}return n.json()}catch(e){if(clearTimeout(i),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function o(e){let t=new AbortController,s=setTimeout(()=>t.abort(),3e4);try{let r=await fetch(`${a}/presets/${e}`,{cache:"no-store",signal:t.signal});if(clearTimeout(s),!r.ok)throw Error(`Preset ${e} not found`);return r.json()}catch(t){if(clearTimeout(s),t instanceof Error&&"AbortError"===t.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",t),t}}let l=a;function c(e=!1){let t=n();return e||(t["Content-Type"]="application/json"),t}},2991:(e,t,s)=>{"use strict";function r(){return""}function a(){return""}function n(e){}function i(){return(process.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes("")}s.d(t,{GJ:()=>i,K3:()=>a,OD:()=>r,d8:()=>n})},89249:(e,t,s)=>{"use strict";s.d(t,{AV:()=>i,Cs:()=>d,E0:()=>b,EQ:()=>f,FA:()=>c,Is:()=>m,M_:()=>l,XB:()=>p,Yj:()=>n,getGlobalAuditLogs:()=>h,hF:()=>a,jQ:()=>g,kF:()=>u,sS:()=>y,sk:()=>x,zc:()=>j});var r=s(6824);async function a(e){try{return await (0,r.SC)("/gdpr/export",{method:"POST",body:JSON.stringify(e)})}catch(e){throw v(e)}}async function n(e){try{let t=await fetch(`/api/proxy/gdpr/export/${e}/download`,{headers:{"Content-Type":"application/octet-stream"}});if(!t.ok)throw Error(`Download failed: ${t.status}`);return await t.blob()}catch(e){throw v(e)}}async function i(e){try{return await (0,r.SC)("/gdpr/purge",{method:"POST",body:JSON.stringify(e)})}catch(e){throw v(e)}}async function o(e){try{return await (0,r.SC)(`/gdpr/jobs/${e}`)}catch(e){throw v(e)}}async function l(e,t){try{let s=new URLSearchParams;t&&s.set("type",t);let a=`/gdpr/jobs?engagement_id=${e}${s.toString()?"&"+s.toString():""}`;return await (0,r.SC)(a)}catch(e){throw v(e)}}async function c(e,t=1,s=50,a){try{let n=new URLSearchParams({engagement_id:e,page:t.toString(),page_size:s.toString()});return a&&n.set("action",a),await (0,r.SC)(`/gdpr/audit-logs?${n.toString()}`)}catch(e){throw v(e)}}async function d(e){try{return await (0,r.SC)(`/gdpr/compliance/${e}`)}catch(e){throw v(e)}}async function u(){try{return await (0,r.SC)("/gdpr/admin/dashboard")}catch(e){throw v(e)}}async function m(){try{return await (0,r.SC)("/gdpr/admin/ttl-policy")}catch(e){throw v(e)}}async function g(e){try{return await (0,r.SC)("/gdpr/admin/ttl-policy",{method:"PUT",body:JSON.stringify(e)})}catch(e){throw v(e)}}async function h(e=1,t=50,s,a){try{let n=new URLSearchParams({page:e.toString(),page_size:t.toString()});return s&&n.set("action",s),a&&n.set("engagement_id",a),await (0,r.SC)(`/gdpr/admin/audit-logs?${n.toString()}`)}catch(e){throw v(e)}}function x(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function p(e,t){return e.trim().toLowerCase()===t.trim().toLowerCase()}function y(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]}function b(e){switch(e){case"completed":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function f(e){switch(e){case"data_export_requested":return"Data Export Requested";case"data_export_completed":return"Data Export Completed";case"data_purge_requested":return"Data Purge Requested";case"data_purge_completed":return"Data Purge Completed";case"data_accessed":return"Data Accessed";case"consent_given":return"Consent Given";case"consent_withdrawn":return"Consent Withdrawn";default:return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}}function v(e){if(e instanceof Error){if(e.message.includes("insufficient permissions"))return{code:"INSUFFICIENT_PERMISSIONS",message:"You do not have permission to perform this GDPR operation.",details:{originalError:e.message}};if(e.message.includes("invalid engagement"))return{code:"INVALID_ENGAGEMENT",message:"The specified engagement does not exist or is not accessible.",details:{originalError:e.message}};if(e.message.includes("export limit exceeded"))return{code:"EXPORT_LIMIT_EXCEEDED",message:"You have exceeded the maximum number of export requests. Please wait before requesting another export.",details:{originalError:e.message}};if(e.message.includes("purge in progress"))return{code:"PURGE_IN_PROGRESS",message:"A data purge operation is already in progress for this engagement.",details:{originalError:e.message}};if(e.message.includes("invalid format"))return{code:"INVALID_FORMAT",message:"The requested export format is not supported.",details:{originalError:e.message}};if(e.message.includes("timeout")||e.message.includes("network"))return{code:"NETWORK_ERROR",message:"Network error occurred. Please check your connection and try again.",details:{originalError:e.message}}}return{code:"UNKNOWN_ERROR",message:"An unexpected error occurred during the GDPR operation.",details:{originalError:e?.message||String(e)}}}class j{constructor(e,t){this.jobId=e,this.onUpdate=t.onUpdate,this.onComplete=t.onComplete,this.onError=t.onError}start(e=2e3){this.stop(),this.intervalId=setInterval(async()=>{try{let e=await o(this.jobId);this.onUpdate?.(e),("completed"===e.status||"failed"===e.status)&&(this.stop(),this.onComplete?.(e))}catch(e){this.stop(),this.onError?.(v(e))}},e)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)}}},56698:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>i});var r=s(19510);s(67272);let a=(0,s(68570).createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/TopNav.tsx#default`);var n=s(46159);let i={title:"AI Maturity Tool",description:"Assess and plan AI security maturity"};function o({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:"min-h-screen bg-gray-50 text-gray-900",children:(0,r.jsxs)(n.Ho,{children:[r.jsx(a,{}),e]})})})}},46159:(e,t,s)=>{"use strict";s.d(t,{Ho:()=>a,g0:()=>n});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#AuthProvider`);(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#useAuth`),(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#useRequireAuth`);let n=(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#getAuthHeaders`)},67272:()=>{}};