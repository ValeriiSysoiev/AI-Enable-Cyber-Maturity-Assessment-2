(()=>{var e={};e.id=233,e.ids=[233],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},72324:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o}),t(52149),t(56698),t(35866);var r=t(23191),a=t(88716),n=t(37922),i=t.n(n),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o=["",{children:["admin",{children:["auth",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,52149)),"/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/admin/auth/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,56698)),"/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/admin/auth/page.tsx"],m="/admin/auth/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/auth/page",pathname:"/admin/auth",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},96484:(e,s,t)=>{Promise.resolve().then(t.bind(t,16247))},34770:(e,s,t)=>{Promise.resolve().then(t.bind(t,79682)),Promise.resolve().then(t.bind(t,70952))},39138:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},16247:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(10326),a=t(79682),n=t(2991),i=t(17577),l=t(6824);function d({className:e=""}){let[s,t]=(0,i.useState)(null),[a,n]=(0,i.useState)("idle"),[d,o]=(0,i.useState)(""),[c,m]=(0,i.useState)(""),u=async()=>{n("loading"),o("");try{let e=await (0,l.SC)("/admin/auth-diagnostics");t(e.diagnostics),m(new Date().toLocaleString()),n("success")}catch(e){o(e instanceof Error?e.message:"Failed to load auth diagnostics"),n("error")}};return"loading"===a?r.jsx("div",{className:`space-y-6 ${e}`,children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})}):"error"===a?r.jsx("div",{className:`space-y-6 ${e}`,children:(0,r.jsxs)("div",{className:"border rounded p-4 bg-red-50 border-red-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"font-medium text-red-800",children:"Error Loading Diagnostics"}),r.jsx("button",{onClick:u,className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}),r.jsx("p",{className:"text-red-700 text-sm",children:d})]})}):s?(0,r.jsxs)("div",{className:`space-y-6 ${e}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-semibold",children:"Authentication Diagnostics"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[c&&(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Last updated: ",c]}),r.jsx("button",{onClick:u,disabled:"loading"===a,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"loading"===a?"Refreshing...":"Refresh"})]})]}),r.jsx("div",{className:"border rounded p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"font-medium",children:"Authentication Mode"}),r.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${"aad"===s.mode?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:"aad"===s.mode?"Azure AD":"Demo"})]})}),(0,r.jsxs)("div",{className:"border rounded p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"font-medium",children:"Configuration Status"}),r.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${(e=>{switch(e){case"ok":return"text-green-600 bg-green-100";case"warning":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(s.configuration.status)}`,children:s.configuration.status.toUpperCase()})]}),s.configuration.issues&&s.configuration.issues.length>0&&(0,r.jsxs)("div",{className:"mt-3 space-y-1",children:[r.jsx("div",{className:"font-medium text-sm text-red-700",children:"Issues:"}),r.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.configuration.issues.map((e,s)=>r.jsx("li",{className:"text-sm text-red-600",children:e},s))})]})]}),"aad"===s.mode&&s.tenant&&(0,r.jsxs)("div",{className:"border rounded p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:"Tenant Information"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"ID:"}),r.jsx("span",{className:"ml-2 font-mono bg-gray-100 px-2 py-1 rounded",children:s.tenant.id})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Name:"}),r.jsx("span",{className:"ml-2",children:s.tenant.name})]})]})]}),s.user&&(0,r.jsxs)("div",{className:"border rounded p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:"Current User"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Email:"}),r.jsx("span",{className:"ml-2",children:s.user.email})]}),s.user.groups&&s.user.groups.length>0&&(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Groups:"}),r.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:s.user.groups.map((e,s)=>r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:e},s))})]}),s.user.roles&&s.user.roles.length>0&&(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Roles:"}),r.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:s.user.roles.map((e,s)=>r.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:e},s))})]})]})]}),s.groups&&s.groups.length>0&&(0,r.jsxs)("div",{className:"border rounded p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:"AAD Groups & Role Mapping"}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b",children:[r.jsx("th",{className:"text-left py-2",children:"Group Name"}),r.jsx("th",{className:"text-left py-2",children:"Group ID"}),r.jsx("th",{className:"text-left py-2",children:"Mapped Role"})]})}),r.jsx("tbody",{children:s.groups.map((e,s)=>(0,r.jsxs)("tr",{className:"border-t",children:[r.jsx("td",{className:"py-2",children:e.name}),r.jsx("td",{className:"py-2 font-mono text-xs",children:e.id}),r.jsx("td",{className:"py-2",children:e.mapped_role?r.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:e.mapped_role}):r.jsx("span",{className:"text-gray-400 text-xs",children:"No mapping"})})]},e.id))})]})})]}),s.roles&&s.roles.length>0&&(0,r.jsxs)("div",{className:"border rounded p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:"Available Roles"}),r.jsx("div",{className:"space-y-3",children:s.roles.map((e,s)=>(0,r.jsxs)("div",{className:"border-l-4 border-blue-200 pl-3",children:[r.jsx("div",{className:"font-medium text-sm",children:e.name}),e.description&&r.jsx("div",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.permissions&&e.permissions.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[r.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Permissions:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:e.permissions.map((e,s)=>r.jsx("span",{className:"px-1 py-0.5 bg-gray-100 text-gray-700 rounded text-xs",children:e},s))})]})]},s))})]})]}):r.jsx("div",{className:`space-y-6 ${e}`,children:r.jsx("div",{className:"text-gray-500 text-center py-8",children:"No diagnostics data available"})})}function o(){let e=(0,a.QL)();return e.isLoading?r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"text-center",children:"Loading..."})}):(0,n.GJ)()?(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"Admin • Authentication"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["User: ",e.user?.name," • Mode: ","aad"===e.mode.mode?"Azure AD":"Demo"]})]}),r.jsx("div",{className:"text-sm text-gray-600 border-l-4 border-blue-200 pl-4",children:"This page provides diagnostic information about the current authentication configuration, including AAD tenant details, group mappings, and role assignments."}),r.jsx(d,{})]}):r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"text-red-600",children:"Access denied. Admin privileges required."})})}},79682:(e,s,t)=>{"use strict";t.d(s,{AuthProvider:()=>l,QL:()=>o,aC:()=>d});var r=t(10326),a=t(17577),n=t(35047);let i=(0,a.createContext)(null);function l({children:e}){let[s,t]=(0,a.useState)(null),[l,d]=(0,a.useState)({mode:"demo",enabled:!0}),[o,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)();return(0,n.useRouter)(),r.jsx(i.Provider,{value:{user:s,mode:l,isAuthenticated:!!s,isLoading:o,error:m},children:e})}function d(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function o(){let e=d();return(0,n.useRouter)(),e}},70952:(e,s,t)=>{"use strict";t.d(s,{default:()=>c});var r=t(10326),a=t(33265),n=t(35047),i=t(17577),l=t(90434),d=t(79682);let o=(0,a.default)(async()=>{},{loadableGenerated:{modules:["components/TopNav.tsx -> ./EngagementSwitcher"]},ssr:!1});function c(){(0,n.usePathname)();let[e,s]=(0,i.useState)(null),t=(0,d.aC)();async function a(){"aad"===t.mode.mode?window.location.href="/api/auth/signout":(localStorage.removeItem("email"),localStorage.removeItem("engagementId"),window.location.href="/signin")}return r.jsx("nav",{className:"bg-white border-b px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-8",children:[r.jsx("h1",{className:"text-lg font-semibold",children:"AI Maturity Tool"}),(0,r.jsxs)("div",{className:"flex space-x-6",children:[r.jsx("a",{href:"/",className:"text-sm hover:text-blue-600",children:"Home"}),r.jsx("a",{href:"/new",className:"text-sm hover:text-blue-600",children:"New Assessment"}),r.jsx("a",{href:"/engagements",className:"text-sm hover:text-blue-600",children:"Engagements"}),e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(l.default,{href:`/e/${e}/dashboard`,className:"text-sm hover:text-blue-600",children:"Dashboard"}),r.jsx(l.default,{href:`/e/${e}/demo`,className:"text-sm hover:text-blue-600",children:"Demo"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[t.isAuthenticated&&t.user&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.user.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${"aad"===t.mode.mode?"bg-green-500":"bg-blue-500"}`}),"aad"===t.mode.mode?"Azure AD":"Demo Mode"]})]}),r.jsx("button",{onClick:a,className:"text-sm text-gray-600 hover:text-gray-900 px-2 py-1 rounded hover:bg-gray-100",children:"Sign Out"})]}),r.jsx(o,{})]})]})})}},6824:(e,s,t)=>{"use strict";t.d(s,{$V:()=>o,SC:()=>i,Sg:()=>d,tQ:()=>l});var r=t(2991);let a=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function n(){let e=(0,r.OD)(),s=(0,r.K3)(),t={};return e&&(t["X-User-Email"]=e),s&&(t["X-Engagement-ID"]=s),t}async function i(e,s={}){let t=n(),r=new AbortController,i=setTimeout(()=>r.abort(),s.timeout||3e4);try{let n=await fetch(`${a}${e}`,{...s,signal:r.signal,headers:{...t,...s.headers}});if(clearTimeout(i),!n.ok){let e=await n.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||`Request failed: ${n.status}`)}return n.json()}catch(e){if(clearTimeout(i),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function l(e){let s=new AbortController,t=setTimeout(()=>s.abort(),3e4);try{let r=await fetch(`${a}/presets/${e}`,{cache:"no-store",signal:s.signal});if(clearTimeout(t),!r.ok)throw Error(`Preset ${e} not found`);return r.json()}catch(s){if(clearTimeout(t),s instanceof Error&&"AbortError"===s.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",s),s}}let d=a;function o(e=!1){let s=n();return e||(s["Content-Type"]="application/json"),s}},2991:(e,s,t)=>{"use strict";function r(){return""}function a(){return""}function n(e){}function i(){return(process.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes("")}t.d(s,{GJ:()=>i,K3:()=>a,OD:()=>r,d8:()=>n})},52149:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/app/admin/auth/page.tsx#default`)},56698:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l,metadata:()=>i});var r=t(19510);t(67272);let a=(0,t(68570).createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/TopNav.tsx#default`);var n=t(46159);let i={title:"AI Maturity Tool",description:"Assess and plan AI security maturity"};function l({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:"min-h-screen bg-gray-50 text-gray-900",children:(0,r.jsxs)(n.Ho,{children:[r.jsx(a,{}),e]})})})}},46159:(e,s,t)=>{"use strict";t.d(s,{Ho:()=>a,g0:()=>n});var r=t(68570);let a=(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#AuthProvider`);(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#useAuth`),(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#useRequireAuth`);let n=(0,r.createProxy)(String.raw`/Users/valsysoiev/AI-Enable-Cyber-Maturity-Assessment-2/web/components/AuthProvider.tsx#getAuthHeaders`)},67272:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,878],()=>t(72324));module.exports=r})();