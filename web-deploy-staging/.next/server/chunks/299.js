"use strict";exports.id=299,exports.ids=[299],exports.modules={22299:(e,s,t)=>{t.d(s,{Z:()=>i});var a=t(10326),n=t(17577),d=t(23820),r=t(2991);function l({className:e="",engagementId:s,showConfig:t=!0,showDocumentStatus:d=!0}){let[l,i]=(0,n.useState)(null),[c,x]=(0,n.useState)(null),[o,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(!0),[g,p]=(0,n.useState)(null),[j,y]=(0,n.useState)(!1);async function b(){try{h(!0),p(null);let e=await fetch("/api/proxy/system/rag-config");if(e.ok){let s=await e.json();i(s)}let t=await fetch("/api/proxy/system/health");if(t.ok){let e=await t.json();x(e)}if(s&&d){let e=await fetch(`/api/proxy/engagements/${s}/docs/ingestion-status`);if(e.ok){let s=await e.json();m(s)}}}catch(e){p(e instanceof Error?e.message:"Failed to load RAG status")}finally{h(!1)}}async function f(){y(!0),await b(),y(!1)}async function N(){if(l&&(0,r.GJ)())try{y(!0);let e=await fetch("/api/proxy/system/rag-test",{method:"POST"});if(e.ok){let s=await e.json();alert(`RAG Test: ${s.status}
${s.message}`)}else alert("RAG test failed")}catch(e){alert(`RAG test error: ${e}`)}finally{y(!1)}}return u?a.jsx("div",{className:`rounded-xl border p-4 ${e}`,children:(0,a.jsxs)("div",{className:"animate-pulse space-y-3",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-3 bg-gray-200 rounded"}),a.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})}):(0,a.jsxs)("div",{className:`space-y-4 ${e}`,children:[t&&l&&(0,a.jsxs)("div",{className:"rounded-xl border p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"font-medium text-lg",children:"RAG System Status"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:f,disabled:j,className:"text-xs text-gray-600 hover:text-gray-800 border border-gray-300 px-2 py-1 rounded",children:j?"⟳ Refreshing...":"\uD83D\uDD04 Refresh"}),(0,r.GJ)()&&a.jsx("button",{onClick:N,disabled:j,className:"text-xs text-blue-600 hover:text-blue-800 border border-blue-300 px-2 py-1 rounded",children:"\uD83E\uDDEA Test RAG"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"font-medium text-sm text-gray-700",children:"Configuration"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Mode:"}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${"azure_openai"===l.mode?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:l.mode})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Status:"}),(0,a.jsxs)("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${function(e){switch(e){case"healthy":return"text-green-600 bg-green-50 border-green-200";case"degraded":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"offline":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}(l.status)}`,children:[function(e){switch(e){case"healthy":return"\uD83D\uDFE2";case"degraded":return"\uD83D\uDFE1";case"offline":return"\uD83D\uDD34";default:return"❓"}}(l.status)," ",l.status]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Enabled:"}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${l.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:l.enabled?"✓ Yes":"✗ No"})]}),l.model&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Model:"}),a.jsx("span",{className:"text-gray-900 font-mono text-xs",children:l.model})]}),l.version&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Version:"}),a.jsx("span",{className:"text-gray-900 font-mono text-xs",children:l.version})]}),l.last_check&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Last Check:"}),a.jsx("span",{className:"text-gray-900 text-xs",children:new Date(l.last_check).toLocaleString()})]})]})]}),c&&(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"font-medium text-sm text-gray-700",children:"System Health"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Search Index:"}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${c.search_index_healthy?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.search_index_healthy?"\uD83D\uDFE2 Healthy":"\uD83D\uDD34 Unhealthy"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Embeddings:"}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${c.embeddings_service_healthy?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.embeddings_service_healthy?"\uD83D\uDFE2 Healthy":"\uD83D\uDD34 Unhealthy"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Documents:"}),(0,a.jsxs)("span",{className:"text-gray-900 text-xs",children:[c.indexed_documents,"/",c.total_documents," indexed"]})]}),c.pending_documents>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Pending:"}),(0,a.jsxs)("span",{className:"text-yellow-600 text-xs",children:["⏳ ",c.pending_documents]})]}),c.failed_documents>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Failed:"}),(0,a.jsxs)("span",{className:"text-red-600 text-xs",children:["❌ ",c.failed_documents]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Last Update:"}),a.jsx("span",{className:"text-gray-900 text-xs",children:new Date(c.last_index_update).toLocaleString()})]})]})]})]}),g&&a.jsx("div",{className:"mt-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded px-3 py-2",children:g})]}),d&&s&&o.length>0&&(0,a.jsxs)("div",{className:"rounded-xl border p-4",children:[a.jsx("div",{className:"font-medium text-lg mb-4",children:"Document Processing Status"}),a.jsx("div",{className:"space-y-2",children:o.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx("span",{className:"text-lg",children:function(e){switch(e){case"completed":return"✅";case"processing":return"⏳";case"pending":return"⏱️";case"failed":return"❌";default:return"❓"}}(e.status)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900 truncate",children:["Document ",e.document_id.slice(-8)]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Status: ",e.status,e.chunks_created&&` • ${e.chunks_created} chunks`,e.processed_at&&` • ${new Date(e.processed_at).toLocaleString()}`]})]})]}),a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${"completed"===e.status?"bg-green-100 text-green-800":"processing"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.status})]},e.document_id))}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{children:["Total: ",o.length," documents"]}),(0,a.jsxs)("span",{children:["Completed: ",o.filter(e=>"completed"===e.status).length]})]})})]}),!l?.enabled&&(0,a.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-amber-600",children:"⚠️"}),a.jsx("span",{className:"font-medium text-amber-900",children:"RAG Not Available"})]}),(0,a.jsxs)("div",{className:"text-sm text-amber-800 space-y-1",children:[a.jsx("div",{children:"• RAG (Retrieval-Augmented Generation) is currently disabled"}),a.jsx("div",{children:"• Evidence search will use basic text matching"}),a.jsx("div",{children:"• Contact your administrator to enable advanced AI-powered search"})]})]}),l?.enabled&&(0,a.jsxs)("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-blue-600",children:"\uD83D\uDCA1"}),a.jsx("span",{className:"font-medium text-blue-900",children:"RAG Tips"})]}),(0,a.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[a.jsx("div",{children:"• Ask specific questions for better grounded answers"}),a.jsx("div",{children:"• Use domain-specific terminology for more relevant results"}),a.jsx("div",{children:"• Combine keywords with context for improved accuracy"}),a.jsx("div",{children:"• Check citation relevance scores to gauge confidence"})]})]})]})}function i({className:e=""}){let[s,t]=(0,n.useState)(!1),[i,c]=(0,n.useState)(null),[x,o]=(0,n.useState)(null),[m,u]=(0,n.useState)("");if(!(0,r.GJ)())return null;async function h(){if(!m.trim()){o("Please enter an engagement ID");return}try{t(!0),o(null),c(null);let e=await (0,d.kR)({engagement_id:m.trim(),force:!0});c(e)}catch(e){o(e instanceof Error?e.message:"Bulk reindex failed")}finally{t(!1)}}async function g(){try{t(!0),o(null),c(null);let e=await (0,d.kR)({engagement_id:"*",force:!0});c(e)}catch(e){o(e instanceof Error?e.message:"Global reindex failed")}finally{t(!1)}}return(0,a.jsxs)("div",{className:`space-y-6 ${e}`,children:[a.jsx(l,{showConfig:!0,showDocumentStatus:!1}),(0,a.jsxs)("div",{className:"rounded-xl border p-4 space-y-4",children:[a.jsx("div",{className:"font-medium text-lg",children:"Evidence Administration"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Admin-only tools for managing evidence search indexes"}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"font-medium",children:"Reindex Engagement"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"Enter engagement ID",className:"flex-1 px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:s}),a.jsx("button",{onClick:h,disabled:s||!m.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Reindexing...":"Reindex"})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-4 border-t",children:[a.jsx("div",{className:"font-medium",children:"Global Operations"}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{onClick:g,disabled:s,className:"px-4 py-2 bg-orange-600 text-white rounded-md text-sm hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Reindexing...":"Reindex All Engagements"})}),a.jsx("div",{className:"text-xs text-gray-500",children:"⚠️ This will reindex all documents across all engagements. Use with caution."})]}),x&&(0,a.jsxs)("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded px-3 py-2",children:["Error: ",x]}),i&&(0,a.jsxs)("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded px-3 py-2",children:[(0,a.jsxs)("div",{className:"font-medium",children:["✓ ",i.message]}),(0,a.jsxs)("div",{className:"text-xs mt-1",children:["Documents queued: ",i.documents_queued,i.estimated_completion_time&&(0,a.jsxs)(a.Fragment,{children:[" • Estimated completion: ",i.estimated_completion_time]})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t text-xs text-gray-500 space-y-1",children:[a.jsx("div",{children:"• Documents are processed in the background"}),a.jsx("div",{children:"• Check individual engagement dashboards for ingestion status"}),a.jsx("div",{children:"• Large document sets may take several minutes to process"}),a.jsx("div",{children:"• RAG functionality requires documents to be successfully indexed"})]})]})]})}}};