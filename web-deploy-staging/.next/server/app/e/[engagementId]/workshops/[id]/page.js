(()=>{var e={};e.id=386,e.ids=[386],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},51317:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>d}),s(86002),s(56698),s(35866);var r=s(23191),n=s(88716),a=s(37922),i=s.n(a),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["e",{children:["[engagementId]",{children:["workshops",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,86002)),"/Users/svvval/Documents/AI-Enable-Cyber-Maturity-Assessment-2/web/app/e/[engagementId]/workshops/[id]/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,56698)),"/Users/svvval/Documents/AI-Enable-Cyber-Maturity-Assessment-2/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/svvval/Documents/AI-Enable-Cyber-Maturity-Assessment-2/web/app/e/[engagementId]/workshops/[id]/page.tsx"],m="/e/[engagementId]/workshops/[id]/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/e/[engagementId]/workshops/[id]/page",pathname:"/e/[engagementId]/workshops/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},46815:(e,t,s)=>{Promise.resolve().then(s.bind(s,75300))},75300:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(10326),n=s(17577),a=s(35047),i=s(90434),l=s(66274);function o({attendee:e,currentUserEmail:t}){return e.consent?(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-green-600",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{className:"text-sm font-medium",children:"Consented"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["at ",new Date(e.consent.timestamp).toLocaleString()]})]}):e.email===t?r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Your consent required"}):r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Consent pending"})}function d({attendee:e,workshopId:t,engagementId:s,currentUserEmail:a,onConsentGiven:i}){let[d,c]=(0,n.useState)(!1),[m,x]=(0,n.useState)(""),h=async()=>{c(!0),x("");try{await (0,l.aM)(s,t,{attendee_id:e.id,consent:!0}),i()}catch(e){x(e instanceof Error?e.message:"Failed to give consent")}finally{c(!1)}};return r.jsx("div",{className:"border rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:r.jsx("div",{className:"flex items-center space-x-3",children:(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e.email}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e.role," • ID: ",e.user_id]})]})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(o,{attendee:e,currentUserEmail:a}),!e.consent&&e.email===a&&(0,r.jsxs)("div",{children:[r.jsx("button",{onClick:h,disabled:d,className:"px-3 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 disabled:opacity-50",children:d?"Giving Consent...":"I Consent to Participate"}),m&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:m})]})]})]})})}function c(){let e=(0,a.useParams)();(0,a.useRouter)();let t=e.engagementId,s=e.id,[o,c]=(0,n.useState)(null),[m,x]=(0,n.useState)(!0),[h,u]=(0,n.useState)(""),[p,g]=(0,n.useState)(!1),f=async()=>{try{x(!0);let e=(await (0,l.SA)(t)).workshops.find(e=>e.id===s);if(!e){u("Workshop not found");return}c(e)}catch(e){u(e instanceof Error?e.message:"Failed to load workshop")}finally{x(!1)}},j=async()=>{if(o){g(!0);try{let e=await (0,l.u7)(t,s);c(e.workshop)}catch(e){u(e instanceof Error?e.message:"Failed to start workshop")}finally{g(!1)}}};if(m)return r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-6"}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),r.jsx("div",{className:"space-y-3",children:[1,2,3].map(e=>r.jsx("div",{className:"h-12 bg-gray-200 rounded"},e))})]})]})})});if(!o)return r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Workshop not found"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:h||"The requested workshop could not be found."}),r.jsx("div",{className:"mt-6",children:r.jsx(i.default,{href:`/e/${t}/workshops`,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:"← Back to Workshops"})})]})})});let y=(0,l.Ao)(o),v=o.attendees.filter(e=>e.consent).length,b=o.attendees.length,w=Math.round(v/b*100);return r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"mb-6",children:r.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,r.jsxs)("ol",{className:"flex items-center space-x-4",children:[r.jsx("li",{children:r.jsx(i.default,{href:`/e/${t}/workshops`,className:"text-gray-500 hover:text-gray-700",children:r.jsx("span",{children:"Workshops"})})}),r.jsx("li",{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"flex-shrink-0 h-4 w-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),r.jsx("span",{className:"ml-4 text-sm font-medium text-gray-900",children:o.title})]})})]})})}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o.title}),(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[(0,r.jsxs)("span",{children:["Created by ",o.created_by]}),r.jsx("span",{children:"•"}),r.jsx("span",{children:new Date(o.created_at).toLocaleString()}),o.start_ts&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("span",{children:"•"}),(0,r.jsxs)("span",{children:["Scheduled for ",new Date(o.start_ts).toLocaleString()]})]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${o.started?"bg-green-100 text-green-800":y?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:o.started?"Started":y?"Ready to Start":"Awaiting Consent"}),o.started&&o.started_at&&(0,r.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:["Started at ",new Date(o.started_at).toLocaleString()]})]})]}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[r.jsx("span",{children:"Consent Progress"}),(0,r.jsxs)("span",{children:[v,"/",b," (",w,"%)"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${w}%`}})})]}),!o.started&&(0,r.jsxs)("div",{className:"mt-6 flex justify-end",children:[r.jsx("button",{onClick:j,disabled:!y||p,className:`px-4 py-2 text-sm font-medium rounded-md ${y&&!p?"text-white bg-green-600 hover:bg-green-700":"text-gray-500 bg-gray-100 cursor-not-allowed"}`,children:p?"Starting Workshop...":"Start Workshop"}),!y&&r.jsx("p",{className:"ml-3 text-xs text-gray-500 self-center",children:"All attendees must consent before workshop can start"})]})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:["Attendees (",o.attendees.length,")"]}),h&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:r.jsx("p",{className:"text-sm text-red-600",children:h})}),r.jsx("div",{className:"space-y-3",children:o.attendees.map(e=>r.jsx(d,{attendee:e,workshopId:s,engagementId:t,currentUserEmail:"",onConsentGiven:f},e.id))})]}),o.started&&(0,r.jsxs)("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Workshop Started"})]}),r.jsx("p",{className:"mt-2 text-sm text-green-700",children:"This workshop has been started and is now in progress. All attendees have successfully given their consent to participate."})]})]})})}},6824:(e,t,s)=>{"use strict";s.d(t,{$V:()=>d,SC:()=>i,Sg:()=>o,tQ:()=>l});var r=s(2991);let n=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function a(){let e=(0,r.OD)(),t=(0,r.K3)(),s={};return e&&(s["X-User-Email"]=e),t&&(s["X-Engagement-ID"]=t),s}async function i(e,t={}){let s=a(),r=new AbortController,i=setTimeout(()=>r.abort(),t.timeout||3e4);try{let a=await fetch(`${n}${e}`,{...t,signal:r.signal,headers:{...s,...t.headers}});if(clearTimeout(i),!a.ok){let e=await a.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||`Request failed: ${a.status}`)}return a.json()}catch(e){if(clearTimeout(i),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function l(e){let t=new AbortController,s=setTimeout(()=>t.abort(),3e4);try{let r=await fetch(`${n}/presets/${e}`,{cache:"no-store",signal:t.signal});if(clearTimeout(s),!r.ok)throw Error(`Preset ${e} not found`);return r.json()}catch(t){if(clearTimeout(s),t instanceof Error&&"AbortError"===t.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",t),t}}let o=n;function d(e=!1){let t=a();return e||(t["Content-Type"]="application/json"),t}},2991:(e,t,s)=>{"use strict";function r(){return""}function n(){return""}function a(e){}function i(){return(process.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes("")}s.d(t,{GJ:()=>i,K3:()=>n,OD:()=>r,d8:()=>a})},66274:(e,t,s)=>{"use strict";s.d(t,{Ao:()=>o,SA:()=>a,aM:()=>i,createWorkshop:()=>n,t6:()=>d,u7:()=>l});var r=s(6824);async function n(e,t){let s={engagement_id:e,title:t.title,start_ts:t.start_ts||null,attendees:t.attendees};return await (0,r.SC)("/api/v1/workshops",{method:"POST",headers:{"Content-Type":"application/json","X-Engagement-ID":e},body:JSON.stringify(s)})}async function a(e,t=1,s=50){let n=new URLSearchParams({engagement_id:e,page:t.toString(),page_size:s.toString()});return await (0,r.SC)(`/api/v1/workshops?${n}`,{headers:{"X-Engagement-ID":e}})}async function i(e,t,s){return await (0,r.SC)(`/api/v1/workshops/${t}/consent`,{method:"POST",headers:{"Content-Type":"application/json","X-Engagement-ID":e},body:JSON.stringify(s)})}async function l(e,t){return await (0,r.SC)(`/api/v1/workshops/${t}/start`,{method:"POST",headers:{"X-Engagement-ID":e}})}function o(e){return e.attendees.every(e=>void 0!==e.consent)}function d(e){let t=e.attendees.length,s=e.attendees.filter(e=>e.consent).length;return{total:t,consented:s,pending:t-s,percentage:t>0?Math.round(s/t*100):0}}},86002:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/Users/svvval/Documents/AI-Enable-Cyber-Maturity-Assessment-2/web/app/e/[engagementId]/workshops/[id]/page.tsx#default`)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,878,34],()=>s(51317));module.exports=r})();