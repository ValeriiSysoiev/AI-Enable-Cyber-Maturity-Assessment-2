(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{79014:function(e,t,n){Promise.resolve().then(n.t.bind(n,47960,23)),Promise.resolve().then(n.bind(n,11265)),Promise.resolve().then(n.bind(n,40582))},11265:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return i},QL:function(){return d},aC:function(){return o}});var s=n(57437),a=n(2265),r=n(99376);let l=(0,a.createContext)(null);function i(e){let{children:t}=e,[n,i]=(0,a.useState)(null),[o,d]=(0,a.useState)({mode:"demo",enabled:!0}),[u,c]=(0,a.useState)(!0),[f,m]=(0,a.useState)();async function h(){try{c(!0),m(void 0);let e=await fetch("/api/auth/mode");if(e.ok){let t=await e.json();if(d(t),"aad"===t.mode&&t.enabled){let e=await fetch("/api/auth/session");if(e.ok){let t=await e.json();t.user&&i({id:t.user.id,email:t.user.email,name:t.user.name,roles:t.user.roles,tenant_id:t.user.tenant_id})}}else{let e=localStorage.getItem("email");e&&i({id:e,email:e,name:e.split("@")[0]})}}}catch(t){console.error("Auth initialization failed:",t),m(t instanceof Error?t.message:"Authentication failed"),d({mode:"demo",enabled:!0});let e=localStorage.getItem("email");e&&i({id:e,email:e,name:e.split("@")[0]})}finally{c(!1)}}return(0,r.useRouter)(),(0,a.useEffect)(()=>{h()},[]),(0,s.jsx)(l.Provider,{value:{user:n,mode:o,isAuthenticated:!!n,isLoading:u,error:f},children:t})}function o(){let e=(0,a.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function d(){let e=o(),t=(0,r.useRouter)();return(0,a.useEffect)(()=>{e.isLoading||e.isAuthenticated||("aad"===e.mode.mode?window.location.href="/api/auth/signin":t.push("/signin"))},[e.isLoading,e.isAuthenticated,e.mode.mode,t]),e}},40582:function(e,t,n){"use strict";n.d(t,{default:function(){return c}});var s=n(57437),a=n(55775),r=n.n(a),l=n(99376),i=n(2265),o=n(27648),d=n(11265);let u=r()(()=>n.e(121).then(n.bind(n,27121)),{loadableGenerated:{webpack:()=>[27121]},ssr:!1});function c(){var e;let t=(0,l.usePathname)(),[n,a]=(0,i.useState)(null),[r,c]=(0,i.useState)(!1),[f,m]=(0,i.useState)(!1),[h,x]=(0,i.useState)(!1),[g,p]=(0,i.useState)(null),b=(0,d.aC)(),j=(0,i.useRef)(null);async function v(){try{let e=await fetch("/api/admin/auth-diagnostics");c(e.ok)}catch(e){c(!1)}}async function y(){try{let e=await fetch("/api/admin/status");if(e.ok){let t=await e.json();p(t)}}catch(e){}}async function w(){"aad"===b.mode.mode?window.location.href="/api/auth/signout":(localStorage.removeItem("email"),localStorage.removeItem("engagementId"),window.location.href="/signin")}(0,i.useEffect)(()=>{let e=t.match(/^\/e\/([^\/]+)/);e?a(e[1]):a(null)},[t]),(0,i.useEffect)(()=>{var e;b.isAuthenticated&&(null===(e=b.user)||void 0===e?void 0:e.email)&&(v(),y())},[b.isAuthenticated,null===(e=b.user)||void 0===e?void 0:e.email]),(0,i.useEffect)(()=>{function e(e){j.current&&!j.current.contains(e.target)&&(x(!1),m(!1))}if(h||f)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[h,f]);let N=n?"/e/".concat(n,"/new"):"/new";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("nav",{className:"bg-white border-b px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,s.jsx)(o.default,{href:"/engagements",className:"text-lg font-semibold hover:text-blue-600",children:"AI Maturity Tool"}),(0,s.jsxs)("div",{className:"flex space-x-6",children:[(0,s.jsx)(o.default,{href:"/engagements",className:"text-sm hover:text-blue-600",children:"Engagements"}),(0,s.jsx)(o.default,{href:N,className:"text-sm hover:text-blue-600",children:"New Assessment"}),n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.default,{href:"/e/".concat(n,"/dashboard"),className:"text-sm hover:text-blue-600",children:"Dashboard"}),(0,s.jsx)(o.default,{href:"/e/".concat(n,"/workshops"),className:"text-sm hover:text-blue-600",children:"Workshops"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[b.isAuthenticated&&b.user&&(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:b.user.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,s.jsx)("span",{className:"inline-block w-2 h-2 rounded-full ".concat("aad"===b.mode.mode?"bg-green-500":"bg-blue-500")}),"aad"===b.mode.mode?"Azure AD":"Demo Mode"]})]}),(0,s.jsxs)("div",{className:"relative",ref:j,children:[(0,s.jsx)("button",{onClick:()=>x(!h),className:"text-sm text-gray-600 hover:text-gray-900 px-2 py-1 rounded hover:bg-gray-100",children:"Menu ▼"}),h&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border z-10",children:[r&&(0,s.jsxs)("div",{className:"px-4 py-2 border-b",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"Admin"}),(0,s.jsx)(o.default,{href:"/admin/presets",className:"block px-2 py-1 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Presets"}),(0,s.jsx)(o.default,{href:"/admin/ops",className:"block px-2 py-1 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Ops"}),(0,s.jsx)(o.default,{href:"/admin/auth-diagnostics",className:"block px-2 py-1 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Auth Diagnostics"}),(0,s.jsx)(o.default,{href:"/admin/gdpr",className:"block px-2 py-1 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"GDPR"}),(0,s.jsx)(o.default,{href:"/admin/modes",className:"block px-2 py-1 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Modes"})]}),(0,s.jsx)("div",{className:"px-4 py-2",children:(0,s.jsx)("button",{onClick:w,className:"block w-full text-left px-2 py-1 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Sign Out"})})]})]})]}),(0,s.jsx)(u,{})]})]})}),g&&(0,s.jsx)("div",{className:"bg-gray-50 border-b px-8 py-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("span",{children:["AUTH: ",g.auth_mode]}),(0,s.jsxs)("span",{children:["DATA: ",g.data_backend]}),(0,s.jsxs)("span",{children:["STORAGE: ",g.storage_mode]}),(0,s.jsxs)("span",{children:["RAG: ",g.rag_mode]}),(0,s.jsxs)("span",{children:["ORCHESTRATOR: ",g.orchestrator_mode]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("span",{children:["v",g.version]}),(0,s.jsx)("span",{className:"text-gray-400",children:"•"}),(0,s.jsx)("span",{children:g.environment})]})]})})]})}},27648:function(e,t,n){"use strict";n.d(t,{default:function(){return a.a}});var s=n(72972),a=n.n(s)},99376:function(e,t,n){"use strict";var s=n(35475);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})},55775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let s=n(47043);n(57437),n(2265);let a=s._(n(15602));function r(e,t){var n;let s={loading:e=>{let{error:t,isLoading:n,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e);let r={...s,...t};return(0,a.default)({...r,modules:null==(n=r.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},81523:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let s=n(18993);function a(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new s.BailoutToCSRError(t);return n}},15602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let s=n(57437),a=n(2265),r=n(81523),l=n(70049);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},n=(0,a.lazy)(()=>t.loader().then(i)),d=t.loading;function u(e){let i=d?(0,s.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(l.PreloadCss,{moduleIds:t.modules}):null,(0,s.jsx)(n,{...e})]}):(0,s.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(n,{...e})});return(0,s.jsx)(a.Suspense,{fallback:i,children:o})}return u.displayName="LoadableComponent",u}},70049:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return r}});let s=n(57437),a=n(20544);function r(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=(0,a.getExpectedRequestStore)("next/dynamic css"),r=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));r.push(...t)}}return 0===r.length?null:(0,s.jsx)(s.Fragment,{children:r.map(e=>(0,s.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},47960:function(){}},function(e){e.O(0,[587,972,971,117,744],function(){return e(e.s=79014)}),_N_E=e.O()}]);