(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{22174:function(e,t,n){Promise.resolve().then(n.bind(n,96734))},96734:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(57437),o=n(2265),s=n(99376),a=n(29116),i=n(58813);function c(){let e=(0,s.useRouter)(),[t,n]=(0,o.useState)(!1),[c,u]=(0,o.useState)(null),[l,f]=(0,o.useState)(null),[d,h]=(0,o.useState)(!1),[m,p]=(0,o.useState)([]),[g,y]=(0,o.useState)("");async function v(){try{let e=await fetch("".concat(a.Sg,"/presets"),{headers:(0,a.$V)()});if(!e.ok)throw Error("Failed to fetch presets: ".concat(e.status));let t=await e.json();p(t),t.length>0&&y(t[0].id)}catch(e){f(e instanceof Error?e.message:"Failed to load presets")}}async function w(){if(!g){f("Please select a preset");return}n(!0),f(null);try{u(await (0,a.tQ)(g))}catch(e){f(e instanceof Error?e.message:"Failed to load preset")}finally{n(!1)}}async function b(){if(!g){f("Please select a preset");return}h(!0),f(null);try{let t=await (0,i.Be)("Demo Assessment",g);e.push("/assessment/".concat(t.id))}catch(e){f(e instanceof Error?e.message:"Failed to create assessment"),h(!1)}}return(0,o.useEffect)(()=>{v()},[]),(0,r.jsxs)("main",{className:"p-8 space-y-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"New Assessment — Scope"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Profile"}),(0,r.jsx)("select",{className:"border rounded px-3 py-2",value:g,onChange:e=>y(e.target.value),children:0===m.length?(0,r.jsx)("option",{value:"",children:"Loading presets..."}):m.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," v",e.version," (",e.counts.questions," questions)"]},e.id))})]}),(0,r.jsx)("button",{onClick:w,className:"px-4 py-2 bg-black text-white rounded",disabled:t,children:t?"Loading…":"Load preset"}),l&&(0,r.jsxs)("div",{className:"p-4 bg-red-50 text-red-700 rounded",children:["Error: ",l]}),c&&(0,r.jsxs)("div",{className:"mt-4 border rounded p-4 bg-white",children:[(0,r.jsx)("p",{className:"font-medium",children:c.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:c.description}),(0,r.jsx)("ul",{className:"mt-2 list-disc list-inside",children:c.pillars.map(e=>(0,r.jsxs)("li",{children:[e.name," — weight ",(100*e.weight).toFixed(0),"%"]},e.id))}),(0,r.jsxs)("p",{className:"mt-2 text-sm",children:["Default target level: ",(0,r.jsx)("b",{children:c.default_target_level})]}),(0,r.jsx)("button",{onClick:b,disabled:d,className:"inline-block mt-3 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:d?"Creating...":"Continue"})]})]})}},29116:function(e,t,n){"use strict";n.d(t,{$V:function(){return u},SC:function(){return a},Sg:function(){return c},tQ:function(){return i}});var r=n(16023);let o=n(40257).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";function s(){let e=(0,r.OD)(),t=(0,r.K3)(),n={};return e&&(n["X-User-Email"]=e),t&&(n["X-Engagement-ID"]=t),n}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=s(),r=new AbortController,a=setTimeout(()=>r.abort(),t.timeout||3e4);try{let s=await fetch("".concat(o).concat(e),{...t,signal:r.signal,headers:{...n,...t.headers}});if(clearTimeout(a),!s.ok){let e=await s.json().catch(()=>({detail:"Request failed"}));throw Error(e.detail||"Request failed: ".concat(s.status))}return s.json()}catch(e){if(clearTimeout(a),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please try again");throw e}}async function i(e){let t=new AbortController,n=setTimeout(()=>t.abort(),3e4);try{let r=await fetch("".concat(o,"/presets/").concat(e),{cache:"no-store",signal:t.signal});if(clearTimeout(n),!r.ok)throw Error("Preset ".concat(e," not found"));return r.json()}catch(t){if(clearTimeout(n),t instanceof Error&&"AbortError"===t.name)throw console.error("Preset fetch timeout:",e),Error("Request timeout - please try again");throw console.error("Error fetching preset:",t),t}}let c=o;function u(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=s();return e||(t["Content-Type"]="application/json"),t}},58813:function(e,t,n){"use strict";n.d(t,{AE:function(){return a},AZ:function(){return i},Be:function(){return o},ee:function(){return s}});let r=n(40257).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";async function o(e,t){let n=await fetch("".concat(r,"/assessments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,preset_id:t})});if(!n.ok)throw Error("Failed to create assessment");return n.json()}async function s(e,t){if(!(await fetch("".concat(r,"/assessments/").concat(e,"/answers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save answer")}async function a(e){let t=await fetch("".concat(r,"/assessments/").concat(e,"/scores"));if(!t.ok)throw Error("Failed to get scores");return t.json()}async function i(e){let t=await fetch("".concat(r,"/assessments/").concat(e));if(!t.ok)throw Error("Failed to get assessment");return t.json()}},16023:function(e,t,n){"use strict";n.d(t,{GJ:function(){return c},K3:function(){return s},OD:function(){return o},Pk:function(){return i},d8:function(){return a}});var r=n(40257);function o(){return localStorage.getItem("email")||""}function s(){return localStorage.getItem("engagementId")||""}function a(e){localStorage.setItem("engagementId",e)}async function i(e){return o()||(await e.push("/signin"),"")}function c(){let e=o();return(r.env.NEXT_PUBLIC_ADMIN_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).includes(e.toLowerCase())}},99376:function(e,t,n){"use strict";var r=n(35475);n.o(r,"useParams")&&n.d(t,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},40257:function(e,t,n){"use strict";var r,o;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(44227)},44227:function(e){!function(){var t={229:function(e){var t,n,r,o=e.exports={};function s(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c=[],u=!1,l=-1;function f(){u&&r&&(u=!1,r.length?c=r.concat(c):l=-1,c.length&&d())}function d(){if(!u){var e=i(f);u=!0;for(var t=c.length;t;){for(r=c,c=[];++l<t;)r&&r[l].run();l=-1,t=c.length}r=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||u||i(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var s=n[e]={exports:{}},a=!0;try{t[e](s,s.exports,r),a=!1}finally{a&&delete n[e]}return s.exports}r.ab="//";var o=r(229);e.exports=o}()}},function(e){e.O(0,[971,117,744],function(){return e(e.s=22174)}),_N_E=e.O()}]);